<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Wineki Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Wineki Blog">
<meta property="og:url" content="http://imwineki.cn/index.html">
<meta property="og:site_name" content="Wineki Blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wineki Blog">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Wineki Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="http://p3.qhimg.com/d/inn/5bb54637/logo.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://p7.qhimg.com/d/inn/c0099c2d/Wineki.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Wineki</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						
						<li>å…³äºæˆ‘</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="http://www.github.com/Wineki" title="github">github</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/HTTP-webä¼ è¾“/" style="font-size: 10px;">HTTP webä¼ è¾“</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">è”ç³»æˆ‘ï¼šwuning_aiali@163.com</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Wineki</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://p7.qhimg.com/d/inn/c0099c2d/Wineki.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Wineki</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="http://www.github.com/Wineki" title="github">github</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-HTTPè§£è¯»ï¼ˆäºŒï¼‰" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/05/HTTPè§£è¯»ï¼ˆäºŒï¼‰/" class="article-date">
  	<time datetime="2016-02-05T03:07:42.000Z" itemprop="datePublished">2016-02-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/05/HTTPè§£è¯»ï¼ˆäºŒï¼‰/">HTTPè§£è¯»ï¼ˆäºŒï¼‰</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-HTTPè§£è¯»ï¼ˆä¸€ï¼‰" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/25/HTTPè§£è¯»ï¼ˆä¸€ï¼‰/" class="article-date">
  	<time datetime="2016-01-25T15:00:38.000Z" itemprop="datePublished">2016-01-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/25/HTTPè§£è¯»ï¼ˆä¸€ï¼‰/">HTTPè§£è¯»ï¼ˆä¸€ï¼‰</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æœ€è¿‘ä¸€ç›´åœ¨å­¦ä¹ HTTPç›¸å…³çŸ¥è¯†ï¼Œå­¦åˆ°çš„çŸ¥è¯†æ€»æ˜¯è¦æ€»ç»“ä¸€ä¸‹å˜›ï¼Œåˆ†å‡ ç¯‡æ–‡ç« æ€»ç»“ç²—æ¥~<br>è¿™ç¯‡ä¸»è¦å†…å®¹å…³äºWebåŸºç¡€ç›¸å…³çš„ï¼ŒçŸ¥è¯†ç‚¹éƒ½æ¯”è¾ƒæµ…æ˜¾æ˜“æ‡‚ï¼Œæ©ï¼Œé—²è¯å°±è¯´åˆ°è¿™é‡Œã€‚<br>HTTPæ˜¯å› ç‰¹ç½‘çš„ä¼ è¾“åª’ä»‹ï¼Œæ˜¯åº”ç”¨å±‚åè®®ï¼Œå®ƒæŠŠè”ç½‘ç»†èŠ‚éƒ½äº¤ç»™äº†é€šç”¨å¯é çš„å› ç‰¹ç½‘ä¼ è¾“åè®®ï¼šTCP/IPã€‚å¤§æ¦‚çš„å…³ç³»å¦‚å›¾:<img src="/img/http2.png" alt="">å½“å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ²Ÿé€šçš„æ—¶å€™å°±éœ€è¦HTTPä½œä¸ºä¿¡ä½¿æ¥ä¼ é€’æ¶ˆæ¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ä¼šç»™æœåŠ¡å™¨å‘é€ä¸€æ¡HTTPè¯·æ±‚ï¼Œè¯·æ±‚éœ€è¦çš„æ–‡æ¡£ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åç»è¿‡å¤„ç†å°±ä¼šç»™å®¢æˆ·ç«¯åšå‡ºä¸€ä¸ªå“åº”ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯å¤„ç†ç»“æœã€‚å½“ç„¶è¿™é‡Œæˆ‘ä»¬è¯´çš„å®¢æˆ·ç«¯å…¶å®å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„æµè§ˆå™¨ã€‚ä¸¾ä¸ªæ —å­ğŸŒ°ï¼Œå½“ä½ åœ¨æµè§ˆå™¨é‡Œè¾“å…¥<a href="http://imwineki.cn/index.html">http://imwineki.cn/index.html</a>,ç„¶åæŒ‰ä¸‹å›è½¦é”®åï¼Œç®€å•æ¥è¯´ï¼Œå°±ä¼šå‘ç”Ÿä»¥ä¸‹è¿™ä¸€äº›åˆ—çš„äº‹æƒ…ï¼Œå¦‚å›¾ï¼Œ<br><img src="/img/http1.png" alt="">æµè§ˆå™¨å°±ä¼šå‘æœåŠ¡å™¨www.imwineki.cnå‘é€ä¸€æ¡HTTPè¯·æ±‚ï¼Œæ­¤æ—¶æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå°±ä¼šå»å¯»æ‰¾index.htmlçš„æ–‡æ¡£ï¼Œæ‰¾åˆ°äº†çš„è¯å°±ä¼šè¿”å›ç»™æµè§ˆå™¨æ–‡æ¡£ä¿¡æ¯ã€‚ä»¥åŠä¸€ä¸ª200çš„çŠ¶æ€ç ï¼Œå¦‚æœå¤±è´¥çš„è¯å°±ä¼šæ ¹æ®å…·ä½“çš„é”™è¯¯æƒ…å†µè¿”å›å…·ä½“çš„é”™è¯¯çŠ¶æ€ã€‚<br>ç¨å¾®å¤æ‚ä¸€ç‚¹æ¥è¯´ï¼Œå½“ä½ æŒ‰ä¸‹å›è½¦åï¼Œhttpä¼šè§£æURLçš„è¯­æ³•ï¼Œé€šå¸¸åŒ…å«ï¼šä»¥ä¸‹å‡ ç§ï¼š<br><img src="/img/http3.png" alt="">ï¼Œè·å–åˆ°<http:imwineki.cn index.html="">ä½¿ç”¨çš„æ˜¯httpåè®®ï¼ŒåŒè¿‡DNSæŸ¥è¯¢ä¸»æœºï¼Œè·å–åˆ°è¯¥åŸŸåä¸‹å¯¹åº”çš„æœåŠ¡å™¨çš„IPåœ°å€ï¼Œä»¥åŠç«¯å£å·ï¼ˆé»˜è®¤æƒ…å†µä¸‹æ˜¯80ç«¯å£ï¼‰ï¼Œè·å–åˆ°æœåŠ¡å™¨çš„IPåœ°å€åï¼Œæ­¤æ—¶å¦‚æœæˆ‘åœŸè±ªçš„ä¹°äº†CDNæœåŠ¡çš„è¯ï¼Œæ¥ä¸‹æ¥ä»£ç†å°±ä¼šå°†è¯·æ±‚å‘é€ç»™ç¼“å­˜ï¼ˆCDNï¼‰ï¼Œç¼“å­˜æ ¹æ®æ–‡ä»¶å‰¯æœ¬çš„æ–°é²œåº¦æ¥å†³å®šè¿”å›å®¢æˆ·ç«¯æ•°æ®è¿˜æ˜¯å‘åŸå§‹æœåŠ¡å™¨å‘å‡ºè¯·æ±‚,å¦‚æœä»£ç†éœ€è¦å‘æœåŠ¡å™¨å‘è¯·æ±‚ï¼Œåˆ™CDNå……å½“å®¢æˆ·ç«¯çš„è§’è‰²ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ˆå…·ä½“è¯·æ±‚å¤´éƒ¨ç­‰è¿™é‡Œå…ˆä¸ä»‹ç»ï¼‰ï¼Œå½“è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨åï¼Œåˆ™é¦–å…ˆåˆ°è¾¾åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¦‚æœåå‘ä»£ç†ä¸­åŒ…å«æ–‡ä»¶å‰¯æœ¬åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™åå‘ä»£ç†å†æ¬¡å‘æœåŠ¡å™¨æˆ–æœåŠ¡å™¨é›†ç¾¤è½¬å‘è¯·æ±‚ï¼Œå¦‚å›¾<img src="/img/http4.png" alt="">ã€‚å½“ç„¶æˆ‘è¯´çš„è¿™äº›æµç¨‹éƒ½æ˜¯å°å‹ç½‘ç«™ï¼Œè‡³äºå¤§å‹ç½‘ç«™æ¶æ„ï¼Œä¸­é—´è¿˜è¦åŒ…å«LVSè´Ÿè½½å‡è¡¡ï¼Œè™šæ‹ŸIPç­‰åŠ é€Ÿå·¥å…·ã€‚è¿™é‡Œéœ€è¦è¯´æ˜çš„ä¸€ç‚¹ï¼šåå‘ä»£ç†å’ŒCDNéƒ½å±äºç¼“å­˜ï¼Œéƒ½æ˜¯ä¸ºäº†å‡å°‘æœåŠ¡å™¨å‹åŠ›ï¼Œé™ä½ç”¨æˆ·ç­‰å¾…æ—¶é—´ï¼ŒåŠ é€Ÿç½‘ç«™ç›¸åº”çš„ï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼šCDNéƒ¨ç½²åœ¨ç½‘ç»œæä¾›å•†çš„æœºæˆ¿ï¼Œåœ¨ç”¨æˆ·å‘å‡ºè¯·æ±‚åï¼Œå¯ä»¥ä¼˜å…ˆä»è·ç¦»æœ€è¿‘çš„ç½‘ç»œæä¾›å•†æœºæˆ¿è·å–æ•°æ®ï¼Œä½†åå‘ä»£ç†åˆ™æ˜¯éƒ¨ç½²åœ¨ä¸­å¿ƒæœºæˆ¿ï¼Œå½“è¯·æ±‚åˆ°æ¥æ—¶ï¼Œä¼šä¼˜å…ˆèµ°åå‘ä»£ç†ã€‚</http:imwineki.cn></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTP-webä¼ è¾“/">HTTP webä¼ è¾“</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Thinkjså®ç°å¼‚æ­¥åŠ è½½æ¨¡æ¿æ–¹æ³•" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/14/Thinkjså®ç°å¼‚æ­¥åŠ è½½æ¨¡æ¿æ–¹æ³•/" class="article-date">
  	<time datetime="2015-12-14T09:23:10.000Z" itemprop="datePublished">2015-12-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/14/Thinkjså®ç°å¼‚æ­¥åŠ è½½æ¨¡æ¿æ–¹æ³•/">Thinkjså®ç°å¼‚æ­¥åŠ è½½</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»Šå¤©æ¥æ€»ç»“ä¸€ä¸‹å…³äºä½¿ç”¨Thinkjsæ¥å®ç°é¡µé¢å¼‚æ­¥åŠ è½½çš„åŸç†å’Œåšæ³•ã€‚<br>æˆ‘ä»å‰ç«¯è®²èµ·ï¼Œé¦–å…ˆæµç¨‹ä¸­åŒ…å«ä¸€ä¸‹å‡ éƒ¨åˆ†ï¼š</p>
<table>
<thead>
<tr>
<th>View</th>
<th style="text-align:center">Controller</th>
<th style="text-align:right">Model</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç­›é€‰æ¡†ï¼ˆfilterï¼‰ç”¨äºç­›é€‰å†…å®¹ï¼Œä½ç½®åœ¨æ¯æ¨¡ç‰ˆ</td>
<td style="text-align:center">æ¯æ¨¡ç‰ˆå¯¹åº”çš„Action</td>
<td style="text-align:right">è°ƒç”¨æ•°æ®åº“</td>
</tr>
<tr>
<td>å¼‚æ­¥åŠ è½½å†…å®¹ï¼ˆcontentï¼‰ï¼Œä½ç½®åœ¨å­æ¨¡æ¿</td>
<td style="text-align:center">ajaxåˆ¤æ–­åçš„å¤„ç†</td>
<td style="text-align:right">è°ƒç”¨æ•°æ®åº“</td>
</tr>
</tbody>
</table>
<p>ä¸‹é¢æ ¹æ®ä»£ç å…·ä½“è§£é‡Šä¸€ä¸‹ï¼š<br>æ¯æ¨¡ç‰ˆçš„viewå±‚demoï¼š</p>
<pre><code><span class="xml">/*è¿™é‡Œæ˜¯ä¸€ä¸ªfilter*/
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"filter"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">dl</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">dt</span>&gt;</span>å¤§å°<span class="tag">&lt;/<span class="title">dt</span>&gt;</span>
        <span class="tag">&lt;<span class="title">dd</span>&gt;</span>
            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span>&gt;</span>å…¨éƒ¨<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span>&gt;</span>å¤§<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span>&gt;</span>ä¸­<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#"</span>&gt;</span>å°<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
        <span class="tag">&lt;/<span class="title">dd</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">dl</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
/*è¿™é‡Œæ˜¯ä¸€ä¸ªcontent*/
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"content"</span>&gt;</span>
    </span>&lt;%<span class="ruby"><span class="keyword">include</span> ajax/tplselectajax.html</span>%&gt;<span class="xml">     /*è¿™é‡Œincludeè¿›æ¥ä¸€ä¸ªå­æ¨¡æ¿ï¼Œå°†æ¥å¼‚æ­¥åˆ·æ–°æ—¶å°±åªåˆ·æ–°å­æ¨¡æ¿æ•°æ®*/
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span>
</code></pre><p>å­æ¨¡æ¿çš„viewå±‚demo:<br>    å¯ä»¥çœ‹åˆ°ä»åç«¯ä¼ æ¥ä¸€ä¸ªtpllistçš„æ•°æ®å­—æ®µï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬æŠŠå®ƒå¾ªç¯è¾“å‡ºå‡ºæ¥ï¼ŒåŒæ—¶ä¸€ä¼šå¼‚æ­¥åˆ·æ–°çš„æ—¶å€™æˆ‘ä»¬ä¹Ÿåªæ˜¯åˆ·æ–°è¿™ä¸ªå­æ¨¡æ¿çš„æ•°æ®ï¼Œè€Œä¸ä¼šæ”¹å˜ä¸Šé¢çš„æ¯æ¨¡æ¿çš„æ•°æ®ã€‚</p>
<pre><code><span class="xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"cont-wrap"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">ul</span>&gt;</span>
        </span><span class="vbscript">&lt;%tpllist.forEach(<span class="keyword">function</span>(item){ %&gt;</span><span class="xml">
            <span class="tag">&lt;<span class="title">li</span>&gt;</span>
                <span class="tag">&lt;<span class="title">p</span>&gt;</span></span><span class="vbscript">&lt;%=item.desc%&gt;</span><span class="xml"><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
                <span class="tag">&lt;<span class="title">p</span>&gt;</span></span><span class="vbscript">&lt;%=item.name%&gt;</span><span class="xml"><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">li</span>&gt;</span>
        </span><span class="vbscript">&lt;%})%&gt;</span><span class="xml">
    <span class="tag">&lt;/<span class="title">ul</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span>
</code></pre><p>å½“ç„¶è¿™é‡Œéœ€è¦jsæ¥å¸®å¿™ä½¿ç”¨ajaxæ¥è¿›è¡Œä¸€æ­¥è°ƒç”¨:</p>
<pre><code>$(<span class="string">'a'</span>).on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>{
    e.preventDefault();
    $.ajax({
        url:<span class="string">''</span>,<span class="comment">/*å¡«å†™è¯·æ±‚è·¯å¾„*/</span>
        dataTpe:<span class="string">'jsonp'</span>,
        data:<span class="string">''</span>,<span class="comment">/*ä¼ é€çš„æ•°æ®*/</span>
        success:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{

        },
        fail:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{

        }

    });
});
</code></pre><p>Controllerå±‚çš„å¤„ç†:</p>
<pre><code>tplselectAction: <span class="function"><span class="keyword">function</span><span class="params">()</span></span>{
    <span class="keyword">var</span> <span class="keyword">self</span> = this;
    <span class="comment">/*è·å–getè¯·æ±‚çš„å‚æ•°ï¼Œåœ¨è¿™ä¸ªdemoä¸­å…¶å®å°±æ˜¯ç­›é€‰æ¡ä»¶*/</span>
    <span class="keyword">var</span> data = this.get();  
    <span class="keyword">var</span> pg = data.pg;
    <span class="comment">/*åˆ¤æ–­æ—¶å€™æ˜¯ajaxè¯·æ±‚ï¼Œå¦‚æœæ˜¯åˆ™ç»“æœè¿”å›true*/</span>
    <span class="keyword">var</span> isAjax = <span class="keyword">self</span>.isAjax();   
    <span class="comment">/*å­æ¨¡æ¿æ¸²æŸ“è·¯å¾„ï¼Œæ³¨æ„æ­¤å¤„æ ¹ç›®å½•æ˜¯Home*/</span>
    <span class="keyword">var</span> tpl = <span class="string">'Home/ajax/build_tplselectajax.html'</span>;         
    <span class="keyword">if</span>(!isAjax){
        <span class="comment">/*å¦‚æœä¸æ˜¯ajaxè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨é¦–æ¬¡æ¸²æŸ“æ•°æ®æ—¶ï¼Œé»˜è®¤é€‰æ‹©å±•ç¤ºå…¨éƒ¨æ•°æ®*/</span>
        data = { cateId: <span class="string">'å…¨éƒ¨'</span>}
    }
    <span class="comment">/*è°ƒç”¨æ•°æ®åº“è·å–æ•°æ®ï¼Œè°ƒç”¨ajaxdataæ–¹æ³•*/</span>
    D(<span class="string">'Template'</span>).ajaxdata(data,pg).then(<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>{
        <span class="keyword">var</span> <span class="keyword">list</span> = shiftObject(data,<span class="string">'data'</span>);  <span class="comment">/*å°†æ•°æ®åº“dataå­—æ®µæ•´ä½“å­˜å…¥list*/</span>
        <span class="keyword">self</span>.assign(<span class="string">'tpllist'</span>,<span class="keyword">list</span>);  
        <span class="keyword">self</span>.assign(<span class="string">'isAjax'</span>,isAjax);
        <span class="keyword">if</span>(isAjax){
            <span class="comment">/*å¦‚æœæ˜¯ajaxæ¨¡æ¿ï¼Œåˆ™åˆ©ç”¨fetchè¿™ä¸ªæ–¹æ³•å¯¹æ¨¡æ¿è¿›è¡Œé‡æ–°æ¸²æŸ“ï¼Œå¹¶è¿”å›ç›¸åº”jsonæ ¼å¼çš„çŠ¶æ€å€¼*/</span>
            <span class="keyword">if</span>(<span class="keyword">list</span>.length !== <span class="number">0</span>){
                <span class="keyword">self</span>.fetch(tpl).then(<span class="function"><span class="keyword">function</span><span class="params">(content)</span></span>{
                   <span class="keyword">self</span>.jsonp({status:<span class="string">"success"</span>,cont:content});
                });
            }<span class="keyword">else</span>{
                <span class="keyword">self</span>.jsonp({status:<span class="string">"fail"</span>,cont:<span class="string">'æš‚æ—¶æœ¨æœ‰ç›¸åº”çš„æ¨¡æ¿ï¼Œæœæœåˆ«çš„è¯•è¯•å§ï¼'</span>});
            }
        }<span class="keyword">else</span>{
            <span class="comment">/*é¦–æ¬¡åŠ è½½é¡µé¢åˆ™ç›´æ¥å±•ç¤º*/</span>
            <span class="keyword">self</span>.display();
        }
    });
}
</code></pre><p>Modelå±‚çš„å¤„ç†demoï¼š</p>
<pre><code>ajaxdata: function(<span class="built_in">data</span>){
    <span class="built_in">var</span> <span class="built_in">self</span> = this;
    <span class="keyword">if</span>(<span class="built_in">data</span><span class="built_in">.</span>cateId = <span class="string">'å…¨éƒ¨'</span>){
        <span class="keyword">return</span> <span class="built_in">self</span><span class="built_in">.</span><span class="keyword">order</span>({<span class="string">'id'</span>:<span class="string">'desc'</span>})<span class="built_in">.</span><span class="keyword">select</span>()<span class="built_in">.</span>then(function(<span class="built_in">data</span>){
            <span class="keyword">return</span> <span class="built_in">data</span>;
        });
    }<span class="keyword">else</span>{
        <span class="keyword">return</span> <span class="built_in">self</span><span class="built_in">.</span><span class="keyword">where</span>({<span class="string">'title'</span>:<span class="built_in">data</span><span class="built_in">.</span>cateId})<span class="built_in">.</span><span class="keyword">order</span>({<span class="string">'id'</span>:<span class="string">'desc'</span>})<span class="built_in">.</span><span class="keyword">select</span>()<span class="built_in">.</span>then(function(<span class="built_in">data</span>){
            <span class="keyword">return</span> <span class="built_in">data</span>;    
        });
    }
}
</code></pre><p>Modelå±‚çš„å¤„ç†ï¼š<br>è¿™é‡Œæ˜¯é¡¹ç›®æºä»£ç çš„æŸ¥è¯¢:</p>
<pre><code>ajaxdata: <span class="function"><span class="keyword">function</span><span class="params">(data,pg)</span></span>{
        var self = this;
        var <span class="keyword">where</span> = <span class="keyword">where</span> || {};
        /*æ­¤å¤„åŒ…å«å…¶ä»–å‚æ•°çš„å¤åˆæŸ¥è¯¢ï¼Œå±•ç¤ºå‡ºæ¥ï¼Œåœ¨demoä¸­æš‚æ—¶ä¸è€ƒè™‘*/
        /*var join = {
            templatecate: {
                join: <span class="string">'left'</span>,
                as: <span class="string">'c'</span>,
                on: [<span class="string">'cateId'</span>,<span class="string">'id'</span>]
            }
        };
        var pg = pg || (isNumber(<span class="keyword">where</span>) ? <span class="keyword">where</span> : null);
        var lastCond = {};
        <span class="keyword">if</span>(<span class="comment">!isEmpty(where)){</span>
            for(var i <span class="type">in</span> <span class="keyword">where</span>){
                var find = false;
                for(var s <span class="type">in</span> fields){
                    <span class="keyword">if</span>(fields[s].indexOf(i) &gt; -<span class="number">1</span>){
                        lastCond[s + <span class="string">'.'</span> + i] = <span class="keyword">where</span>[i];
                        find = true;
                        break;
                    }
                }
                <span class="keyword">if</span>(find)<span class="keyword">continue</span>;
                lastCond[<span class="string">'t.'</span> + i] = <span class="keyword">where</span>[i];
            }
        }*/
        <span class="keyword">if</span>(<span class="type">data</span>.cateId == <span class="string">'å…¨éƒ¨'</span>){
            var per = C(<span class="string">'db_nums_per_page'</span>);
            /*åœ¨ç­›é€‰æ¡†ä¸ºâ€˜å…¨éƒ¨â€™æ—¶ï¼Œå°†æ•°æ®ä¸­å…¨éƒ¨æ•°æ®æŒ‰æ¡ä»¶æŸ¥è¯¢å‡ºæ¥ï¼Œå¹¶ä¸”è¿›è¡Œåˆ†é¡µæŸ¥è¯¢ï¼ˆåˆ†é¡µæŸ¥è¯¢æ­¤å¤„æˆ‘ä»¬æš‚æ—¶ä¸è®¨è®ºï¼‰*/
            <span class="keyword">return</span> self.<span class="keyword">where</span>({<span class="string">'endType'</span>:<span class="type">data</span>.<span class="keyword">endType</span>,<span class="string">'isForbidden'</span>:<span class="number">0</span>}).order({<span class="string">'id'</span>: <span class="string">'desc'</span>}).page(pg).<span class="keyword">select</span>().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>{
                    <span class="keyword">return</span> <span class="type">data</span>;
            }).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(datalist)</span></span>{
                /*å°†è¿”å›ç»“æœè¿›è¡Œå¤„ç†ï¼Œå¹¶è¿”å›ç›¸åº”çš„å‚æ•°*/
                <span class="keyword">return</span> self.field(<span class="string">'count(id) as count'</span>).<span class="keyword">where</span>({<span class="string">'endType'</span>:<span class="type">data</span>.<span class="keyword">endType</span>}).find().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>{
                    <span class="keyword">return</span> {
                        <span class="type">data</span>: datalist,
                        <span class="built_in">count</span>: res.<span class="built_in">count</span>,
                        page: pg || <span class="number">1</span>,
                        num: per,
                        total: Math.ceil(res.<span class="built_in">count</span> / per)
                    };
                });
            }); 
        }<span class="keyword">else</span>{
            /ajaxè¯·æ±‚æ˜¯æŸ¥è¯¢ç»“æœï¼ŒæŒ‰ç…§cateIdçš„å€¼è¿›è¡ŒæŸ¥è¯¢/
            var per = C(<span class="string">'db_nums_per_page'</span>);
            <span class="keyword">return</span> self.alias(<span class="string">'t'</span>).field(<span class="string">'t.*'</span>).join(join).<span class="keyword">where</span>({<span class="string">'c.title'</span>:<span class="type">data</span>.cateId,<span class="string">'t.endType'</span>:<span class="type">data</span>.<span class="keyword">endType</span>,<span class="string">'isForbidden'</span>:<span class="number">0</span>}).order({<span class="string">'t.id'</span>: <span class="string">'desc'</span>}).page(pg).<span class="keyword">select</span>().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>{
                    <span class="keyword">return</span> <span class="type">data</span>;
            }).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(datalist)</span></span>{
                <span class="keyword">return</span> self.alias(<span class="string">'t'</span>).field(<span class="string">'count(t.id) as count'</span>).join(join).<span class="keyword">where</span>({<span class="string">'c.title'</span>:<span class="type">data</span>.cateId,<span class="string">'t.endType'</span>:<span class="type">data</span>.<span class="keyword">endType</span>}).find().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(res)</span></span>{
                    <span class="keyword">return</span> {
                        <span class="type">data</span>: datalist,
                        <span class="built_in">count</span>: res.<span class="built_in">count</span>,
                        page: pg || <span class="number">1</span>,
                        num: per,
                        total: Math.ceil(res.<span class="built_in">count</span> / per)
                    };
                });
            }); 
        }

    }
</code></pre><p>å…³äºThinkjsé‡Œé¢çš„å…·ä½“è¯­æ³•æˆ‘å°±ä¸ä¸€ä¸€è§£é‡Šäº†ï¼Œè¿™é‡Œä¸»è¦æ¥è®²ä¸€ä¸‹å¤§æ¦‚çš„æ€è·¯ï¼Œé¦–å…ˆå‰ç«¯éœ€è¦åœ¨æ¨¡æ¿ä¸­å°†éœ€è¦å¼‚æ­¥åŠ è½½çš„æ¨¡æ¿è¿›è¡Œinclude,æ–¹ä¾¿åç»­çš„å¼‚æ­¥åˆ·æ´—é¡µé¢ï¼ŒåŒæ—¶ä½ éœ€è¦ç”¨jsæ¥è¿›è¡Œä¸€ä¸ªajaxçš„é€šä¿¡ï¼Œæ¥ç€å°±æ˜¯Controllerå±‚å¯¹æ¨¡æ¿çš„æ¸²æŸ“ï¼Œåœ¨æ‹¿åˆ°å‰ç«¯ä¼ æ¥çš„è¯·æ±‚æ•°æ®åï¼Œè°ƒç”¨modelå±‚çš„æ–¹æ³•ä»æ•°æ®åº“ä¸­å–å‡ºæ•°æ®ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨fetehè¿™ä¸ªæ–¹æ³•é‡æ–°æ¸²æŸ“é¡µé¢ã€‚ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ä½¿ç”¨display(æ¸²æŸ“æ¨¡æ¿è·¯å¾„)è¿™ä¸ªæ–¹æ³•ï¼Œåªæ˜¯æ¸²æŸ“çš„æ–¹å¼ä¸ç”¨è€Œå·²ï¼Œç»“æœæ˜¯ä¸€æ ·çš„ï¼‰æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æœä¸€ä¸‹APIã€‚<br>sqlè¯­å¥å†™çš„ä¸å¥½ï¼Œè¿˜æœ›å¤§å®¶è§è°…~~å“ˆå“ˆå“ˆï¼Œå…ˆå°±è¿™ä¹ˆå¤š~</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-cssé€‰æ‹©å™¨ä¼˜å…ˆçº§æƒé‡åˆ†æ" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/25/cssé€‰æ‹©å™¨ä¼˜å…ˆçº§æƒé‡åˆ†æ/" class="article-date">
  	<time datetime="2015-11-25T15:25:41.000Z" itemprop="datePublished">2015-11-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/25/cssé€‰æ‹©å™¨ä¼˜å…ˆçº§æƒé‡åˆ†æ/">cssé€‰æ‹©å™¨ä¼˜å…ˆçº§æƒé‡åˆ†æ</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æœ€è¿‘å†™é¡¹ç›®å‘ç°äº†cssçš„ä¸€äº›å°é—®é¢˜æ€»ç»“å‡ºæ¥ï¼Œä¸»è¦æ˜¯å…³äºcssé€‰æ‹©å™¨æƒé‡ç›¸å…³çš„ã€‚<br>åœ¨æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¼–å†™é¡µé¢æ ·å¼çš„æ—¶å€™é€šå¸¸éƒ½è¦è€ƒè™‘é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—é¡µé¢çš„æ ·å¼ä¸ä¼šè¢«è¦†ç›–æˆ–è¦†ç›–å…¶ä»–æ ·å¼ã€‚<br>æ€»ä½“æ¥è¯´ä¼˜å…ˆçº§æ˜¯è¿™æ ·çš„ï¼ˆæ­¤å¤„ä»é«˜åˆ°åº•æ’åºï¼‰ï¼š</p>
<blockquote>
<p>!important  -&gt;   è¡Œå†…æ ·å¼style(æ­¤å¤„åŒ…å«å†™åœ¨htmlç»“æ„ä¸­çš„å’Œç”¨jsåŠ¨æ€åŠ è½½ä¸Šå»çš„style)  -&gt;  idé€‰æ‹©å™¨  -&gt;  ä¼ªç±»  -&gt;  classé€‰æ‹©å™¨  -&gt;  å…ƒç´ é€‰æ‹©å™¨  -&gt;  é€šç”¨é€‰æ‹©å™¨( * )</p>
</blockquote>
<p>è¿™é‡Œæˆ‘æ¥å¯¹ä¸€äº›ç»†èŠ‚è¯´æ˜ä¸€ä¸‹ï¼š<br>1.é¡µé¢ä¸­èƒ½ä¸è¦ä½¿ç”¨ï¼importantå°½é‡é¿å…ä½¿ç”¨ï¼Œå› ä¸ºä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œï¼importantä¸ä¼˜å…ˆçº§æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œå½“ä½¿ç”¨!importantå®šä¹‰æ¨¡å—çš„æ—¶å€™é¡µé¢ä¸­å†å¯¹å…¶è¿›è¡Œä»»ä½•æ“ä½œéƒ½æ— æµäºäº‹äº†ï¼Œæ”¹å˜äº†æ ·å¼è¡¨æœ¬æ¥çš„çº§è”è§„åˆ™ï¼Œéš¾ä»¥è°ƒè¯•ã€‚<br>2.è¡Œå†…æ ·å¼è¿™é‡Œçš„ä¸¤æ–¹é¢è·ç¦»è¯´æ˜ï¼š</p>
<pre><code><span class="number">1</span>.&lt;<span class="tag">p</span> style=<span class="string">"color:red"</span> id=<span class="string">"test"</span>&gt;&lt;/p&gt;

<span class="number">2</span>. document.<span class="function"><span class="title">getElementById</span><span class="params">(<span class="string">'topnav'</span>)</span></span><span class="class">.style</span><span class="class">.color</span> = <span class="string">'red'</span>
</code></pre><p>3.å…³äºä¼ªç±»çš„ä¼˜å…ˆçº§éµå¾ªï¼šLVHA,ä»å³å‘å·¦ä¼˜å…ˆçº§é€çº§å¢åŠ .ç„¶è€Œnotä½œä¸ºä¼ªç±»ï¼Œå´å¹¶ä¸åˆ—å…¥ä¼ªç±»ä¼˜å…ˆçº§çš„è¯„æ¯”ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å…ƒç´ æœ‰é‡æ–°å®šä¹‰çš„æ ·å¼çš„æ—¶å€™notä¼šè¢«è‡ªåŠ¨è¦†ç›–ã€‚ä¸¾ä¾‹è¯´æ˜ï¼š</p>
<pre><code>&lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"test-not"</span>&gt;æµ‹è¯•ä¼ªç±»<span class="keyword">not</span>&lt;/<span class="keyword">div</span>&gt;
&lt;<span class="keyword">div</span> <span class="type">class</span>=<span class="string">"not"</span>&gt;<span class="number">123</span>&lt;/<span class="keyword">div</span>&gt;
</code></pre><p>å½“å®šä¹‰æ ·å¼ä¸ºï¼š</p>
<pre><code><span class="rule"><span class="attribute">.test-not</span>:<span class="value"><span class="function">not</span>(.not){
    color:red</span></span>;
}
</code></pre><p>æ•ˆæœå¦‚ä¸‹å›¾ï¼š<br><img src="/img/1.png" alt=""><br>123ä¸ºé»‘è‰²ï¼Œè¯´æ˜æ ·å¼ä¸­notç”Ÿæ•ˆäº†ã€‚<br>å½“å®šä¹‰æ ·å¼ä¸ºï¼š</p>
<pre><code><span class="class">.not</span><span class="rules">{
    <span class="rule"><span class="attribute">color</span>:<span class="value">red</span></span>;
}</span>
<span class="rule"><span class="attribute">.test-not</span>:<span class="value"><span class="function">not</span>(.not){
    color:red</span></span>;
}
</code></pre><p>æ•ˆæœå¦‚ä¸‹å›¾ï¼š<br><img src="/img/2.png" alt=""><br>123æ˜¾ç¤ºä¸ºçº¢è‰²ï¼Œè¯´æ˜notæ ·å¼è¢«å…ƒç´ æœ¬èº«å®šä¹‰çš„æ ·å¼è¦†ç›–äº†ã€‚<br>4.å…³äºaæ ‡ç­¾çš„è¯´æ˜ï¼š</p>
<pre><code>a:link{
    <span class="built_in">color</span>:<span class="built_in">green</span>;
}
<span class="comment">/*a:visited{
    color:yellow;
}*/</span>
.test{
    <span class="built_in">color</span>:<span class="built_in">red</span>;
}
&lt;a href=<span class="string">"/"</span> class=<span class="string">"test-relative"</span>&gt;ç›¸å¯¹ç›®å½•&lt;/a&gt;
</code></pre><p>å½“æˆ‘ä»¬æŠŠaæ ‡ç­¾åŠ ä¸Šlinkä¼ªç±»çš„æ—¶å€™ï¼Œlinkçš„ä¼˜å…ˆçº§å°±é«˜äºclass=â€testâ€,æ‰€ä»¥åœ¨é¦–æ¬¡è½½å…¥é¡µé¢çš„æ—¶å€™æ–‡å­—ä¼šæ˜¾ç¤ºç»¿è‰²ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»é“¾æ¥åï¼Œå‘ç°æ–‡å­—åˆå˜å›äº†çº¢è‰²ï¼Œè¿™æ˜¯å› ä¸ºé“¾æ¥ç‚¹å‡»åçš„çŠ¶æ€ä¸ºvisitedï¼Œè€Œåœ¨æ ·å¼ä¸­æˆ‘ä»¬å°†visitedçš„æ ·å¼å®šä¹‰æ³¨é‡Šæ‰äº†ï¼Œæ‰€ä»¥é“¾æ¥æ ·å¼å°±ä¼šç›´æ¥æ˜¾ç¤ºclass=â€testâ€çš„æ ·å¼äº†ã€‚<br>å½“æˆ‘ä»¬å°†visitedçš„æ ·å¼å®šä¹‰å»æ‰åï¼Œä¼šå‘ç°é¢œè‰²æ˜¾ç¤ºä¸ºé»„è‰²ã€‚</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Thinkjsé“¾å¼ç»“æ„æ€»ç»“" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/25/Thinkjsé“¾å¼ç»“æ„æ€»ç»“/" class="article-date">
  	<time datetime="2015-11-25T15:12:59.000Z" itemprop="datePublished">2015-11-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/25/Thinkjsé“¾å¼ç»“æ„æ€»ç»“/">Thinkjsé“¾å¼ç»“æ„æ€»ç»“</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç¬¬ä¸€ç¯‡åšæ–‡ï¼Œç”±äºåˆšå¼€å§‹å­¦ä¹ markdownçš„æ–¹å¼å†™åšæ–‡ï¼Œé€Ÿåº¦å¥½æ…¢ã€‚<br><br>æœ€è¿‘åœ¨ç”¨<em>Thinkjs</em>å†™é¡¹ç›®ï¼Œåˆå‘ä»å‰ç«¯åˆ°å…¨æ®µçš„æ¢¦æƒ³è¿ˆè¿›äº†ä¸€æ­¥ï¼Œå“ˆå“ˆï¼Œå†™è¯å°‘è¯´ï¼Œshareä¸€äº›å¹²è´§ç²—æ¥ã€‚<br><br><em>Thinkjs</em>æ˜¯åŸºäºnodejsçš„webæ¡†æ¶ï¼Œå…·ä½“çš„æ–‡æ¡£å¯ä»¥å‚çœ‹<a href="https://thinkjs.org/" target="_blank" rel="external">https://thinkjs.org/</a>å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯1.0ç‰ˆæœ¬ï¼Œæ‰€ä»¥æš‚æ—¶åªè®¨è®º1.0çš„ä¸€äº›æƒ…å†µã€‚<br>ä»Šå¤©å†™é¡¹ç›®ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š<br>æˆ‘ä»sessionä¸­è·å–åˆ°ç”¨æˆ·çš„ä¿¡æ¯ï¼Œç„¶åè·å–å­˜åœ¨sessionä¸­çš„userNameï¼Œä½¿ç”¨ï¼š</p>
<pre><code><span class="keyword">this</span>.session(<span class="string">"userInfo"</span>).then(<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>{
...
});
</code></pre><p>çš„æ–¹å¼ï¼Œå¦ä¸€æ–¹é¢æˆ‘é€šè¿‡æ•°æ®åº“æŸ¥è¯¢è·å–åˆ°ç”¨æˆ·åœ¨æ•°æ®åº“ä¸­å­˜å‚¨çš„userName,ç„¶åæ¯”è¾ƒè¿™ä¸¤ä¸ªuserNameæ—¶å€™å¦ç›¸åŒï¼Œä½¿ç”¨</p>
<pre><code><span class="tag">D</span>(<span class="string">'User'</span>)<span class="class">.get</span>(id)<span class="class">.then</span>(<span class="function">function</span>(data){
...
}); 
</code></pre><p>å†å°†ä¸€ä¸ªæ ‡ç­¾å€¼assignåˆ°viewå±‚å¯¹åº”çš„é¡µé¢ã€‚<br>ç„¶è€Œå°±åœ¨ç¼–å†™çš„è¿‡ç¨‹ä¸­æˆ‘å‘ç°æˆ‘åœ¨æ¯”è¾ƒä¹‹åï¼Œæ— æ³•å°†æ ‡ç­¾å€¼ä¼ å…¥é¡µé¢ã€‚<br>å…·ä½“ä»£ç å¦‚å›¾ï¼š<br><img src="http://p6.qhimg.com/d/inn/f451a883/code.png" alt="1"><br>è¿™æ˜¯ä¸€ä»½ä¼ªä»£ç ï¼Œä¸Šé¢çš„å›¾ç‰‡çš„å¤§æ¦‚æ„æ€å°±æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code><span class="keyword">return</span> D(<span class="string">'User'</span>).get(id).then(<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>{
    <span class="keyword">return</span> <span class="keyword">self</span>.session(<span class="string">'user'</span>).then(<span class="function"><span class="keyword">function</span><span class="params">(user)</span></span>{
        <span class="comment">//éªŒè¯sessionä¿¡æ¯,è¿”å›editable</span>
        <span class="keyword">self</span>.assign(<span class="string">'editable'</span>,editable);
        <span class="keyword">self</span>.assign(<span class="string">'user'</span>,data);
        <span class="keyword">self</span>.display();
    });
});
</code></pre><p>æœ€åˆæˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<pre><code><span class="keyword">return</span> D(<span class="string">'User'</span>).get(id).then(<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span>{
    <span class="keyword">var</span> session = <span class="keyword">self</span>.session(<span class="string">'user'</span>).then(<span class="function"><span class="keyword">function</span><span class="params">(user)</span></span>{
        <span class="comment">//éªŒè¯sessionä¿¡æ¯,è¿”å›editable</span>
        <span class="keyword">self</span>.assign(<span class="string">'editable'</span>,editable);
    });
    <span class="keyword">self</span>.assign(<span class="string">'user'</span>,data);
    <span class="keyword">self</span>.display();
});
</code></pre><p>ç„¶åæˆ‘å‘ç°è¿™ä¸ªæ ¹æœ¬æ²¡æœ‰æƒ³ä¸‹æ‰§è¡Œï¼Œé¡µé¢ç›´æ¥ç™½å±äº†ï¼ŒåŸå› å…¶å®æ˜¯è¿™æ ·çš„ï¼Œåœ¨<em>thinkjs</em>ä¸­ç»å¤§å¤šæ•°æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥è°ƒç”¨çš„ï¼Œå¹¶ä¸”åŒ…è£…æˆpromiseï¼Œè€Œpromiseæ˜¯é€šè¿‡<br><em>try{}catch{}</em>è¿›è¡Œå¼‚å¸¸æ•è·çš„ï¼Œå¾ˆæ˜¾ç„¶æˆ‘æ²¡æœ‰catchå¼‚å¸¸æ‰€ä»¥å¯¼è‡´ç›´æ¥ç™½å±ï¼ŒåŒæ—¶ç”±äºthinkjsä¸­è®¸å¤šçš„è°ƒç”¨éƒ½æ˜¯å¼‚æ­¥è°ƒç”¨ï¼ˆè¿™ä¸ªä¹‹å‰è¯´è¿‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨sessionè¿˜æ²¡æœ‰è¿”å›å€¼çš„æ—¶å€™ç¨‹åºå°±å‘ä¸‹æ‰§è¡Œäº†ï¼Œä½†æ˜¯æ­¤å¤„æˆ‘å¿…é¡»è¦å®ƒåŒæ­¥æ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´æŒ‰ç…§ç¨‹åºå†™çš„å…ˆåé¡ºåºæ¥æ‰§è¡Œï¼Œæ‰€ä»¥å°±é‡‡ç”¨returnçš„æ–¹æ³•ï¼Œå°†æ²¡æœ‰ä¸ªå¼‚æ­¥æ–¹æ³•ä¸²è”èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªè°ƒç”¨é“¾å°±æå®šäº†ã€‚</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Wineki
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>